<!-- <ion-breadcrumbs color="primary">
  <ion-breadcrumb href="/home">
    <ion-icon slot="start" name="home"></ion-icon>
    Inicio
  </ion-breadcrumb>
  <ion-breadcrumb href="/tickets">
    <ion-icon slot="start" name="megaphone-outline"></ion-icon>
    Casos
  </ion-breadcrumb>
</ion-breadcrumbs> -->

<ion-content>
  <ion-grid>
    <ion-row class="ion-justify-content-center">
      <ion-col size="12">
        <ion-item class="round">
          <ion-col size="2">
            <ion-label><strong>Administrador de Casos</strong></ion-label>
          </ion-col>
          <ion-col size="9">
            <ion-searchbar mode="ios" placeholder="Buscar por nombre o numero de tienda, o folio del ticket..." (ionChange)="onSearchChange($event)" [debounce]="500"></ion-searchbar>
          </ion-col>
        </ion-item>
      </ion-col>
    </ion-row>
    <ion-row class="ion-justify-content-center ion-align-items-center round fondo-white">
      <ion-col size-md="2" size-sm="12">
        <ion-item>
          <ion-label><strong>Tiendas</strong></ion-label>
          <ion-select placeholder="Seleccione tienda" interface="popover"
            (ionChange)="onChangeTienda(tiendaTicket.value)" #tiendaTicket [(ngModel)]="laTiendaSeleccionadaId">
            <ion-select-option [value]="tienda.tiendaId" *ngFor="let tienda of lasTiendasUser">{{ tienda.nombre }}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-col>
      <ion-col size-md="2" size-sm="12">
        <ion-item>
          <ion-label><b>Estatus</b></ion-label>
          <ion-select placeholder="Seleccione estatus" interface="popover"
            (ionChange)="onChangeEstatus(estatusTicket.value)" #estatusTicket>
            <ion-select-option [value]="estatus.estatusId" *ngFor="let estatus of this.losEstatus">{{ estatus.nombre }}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-col>
      <ion-col size-md="2" size-sm="12">
        <ion-item>
          <ion-label> <b>Tipo</b></ion-label>
          <ion-select placeholder="Seleccione tipo" interface="popover" (ionChange)="onChangeTipo(tipoTicket.value)" #tipoTicket>
            <ion-select-option *ngFor="let tipos of this.losTipos" [value]="tipos.tipoId">
              <ion-icon slot="start" name="caret-forward-outline"></ion-icon> {{tipos.nombre }}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-col>
      <ion-col size-md="3" size-sm="12">

        <ion-item button="true" id="open-modal-ini">
          <ion-label><b>Fecha Inicio</b>
          </ion-label>
          <ion-input [value]="dateFechaIni"></ion-input>
          <ion-icon name="calendar-outline"></ion-icon>
          <ion-modal trigger="open-modal-ini" id="modal-bottom">
            <ng-template>
              <ion-content>
                <ion-datetime class="ion-text-center" #popoverDatetime presentation="date"
                  (ionChange)="onFechaIniSelected($event)">
                </ion-datetime>
              </ion-content>
            </ng-template>
          </ion-modal>
        </ion-item>

      </ion-col>
      <ion-col size-md="3" size-sm="12">

        <ion-item button="true" id="open-modal-fin">
          <ion-label><b>Fecha Fin</b>
          </ion-label>
          <ion-input [value]="dateFechaFin"></ion-input>
          <ion-icon name="calendar-outline"></ion-icon>
          <ion-modal trigger="open-modal-fin" id="modal-bottom">
            <ng-template>
              <ion-content>
                <ion-datetime class="ion-text-center" #popoverDatetime presentation="date"
                  (ionChange)="onFechaFinSelected($event)">
                </ion-datetime>
              </ion-content>
            </ng-template>
          </ion-modal>
        </ion-item>

      </ion-col>
    </ion-row>

    <ion-row *ngIf="!cargando">
      <ion-col size="12">
        <ion-item>

          <ion-grid fixed>
            <ion-row class="header">
              <ion-col size="3">Folio</ion-col>
              <ion-col size="1">Fecha</ion-col>
              <ion-col size="3">Tienda</ion-col>
              <ion-col size="2" class="ion-hide-sm-down">Tipo</ion-col>
              <ion-col size="2" class="ion-hide-sm-down">Estatus</ion-col>
              <ion-col size="1"></ion-col>
            </ion-row>
            <ion-row *ngFor="let ticket of listadoTickets" class="border-grid-row">
              <ion-col size="3">
                {{ ticket.folio}}
              </ion-col>
              <ion-col size="1">
                {{ ticket.fechaAlta | date: 'dd/MM/yy' }}
              </ion-col>
              <ion-col size="3">
                {{ ticket.tienda.nombre }} | {{ ticket.tienda.identificadorExterno }}
              </ion-col>
              <ion-col size="2" class="ion-hide-sm-down">
                <app-tipos-ticket [ticketTipos] ="ticket.ticketTipos"></app-tipos-ticket>
              </ion-col>
              <ion-col size="2" class="ion-hide-sm-down">
                <app-estatus-color [icon]="ticket.estatus.iconName" [status]="ticket.estatus.nombre"></app-estatus-color>
              </ion-col>
              <ion-col size="1">
                <ion-buttons>
                  <ion-button slot="end" color="danger" (click)="mostrarMenu($event, ticket)">
                    <ion-icon slot="icon-only" ios="ellipsis-horizontal" md="ellipsis-vertical"></ion-icon>
                  </ion-button>
                </ion-buttons>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>
      </ion-col>
    </ion-row>

  </ion-grid>

  <ion-grid class="ion-text-center" *ngIf="!cargando && listadoTickets.length > 0">
    <ion-row>
      <ion-col class="2">
        <ion-chip (click)="cambiarPagina(paginaActual - 1)" color="danger" class="cursor"
          [disabled]="paginaActual === 1 ? true: false">
          <ion-icon name="caret-back-outline"></ion-icon>
        </ion-chip>
      </ion-col>
      <ion-col class="8">
        <ion-badge id="id{{ i }}" [color]=" activePage === i ? 'danger': 'medium'" (click)="cambiarPagina(i + 1)"
          class="m-3 p-10 cursor" *ngFor="let pagina of totalPaginasArray; let i = index">{{ i + 1 }}</ion-badge>
        <span *ngIf="paginaActual>10">...</span>
        <ion-badge color="danger" class="m-3 p-10 cursor" *ngIf="paginaActual>10"
          (click)="cambiarPagina(paginaActual + 1)">{{ paginaActual }}</ion-badge>
      </ion-col>
      <ion-col class="2">
        <ion-chip (click)="cambiarPagina(paginaActual + 1)" color="danger" class="cursor"
          [disabled]="paginaActual === noPaginas ? true: false">
          <ion-icon name="caret-forward-outline"></ion-icon>
        </ion-chip>
      </ion-col>
    </ion-row>
  </ion-grid>
  <app-no-hay-resultados *ngIf="!cargando && listadoTickets.length === 0" [text]="'No hay resultados...'"></app-no-hay-resultados>
</ion-content>
